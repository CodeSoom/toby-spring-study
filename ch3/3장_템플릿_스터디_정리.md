# 3장 템플릿
## (토비 님)
여러 종류의 템플릿으로 끝나는 기술들이 있고 여러분들이 접하실 가능성도 꽤 있고, 간단한 것만 쓰면 감춰져서 안보이는 부분에서 동작하는 경우도 많이 있다. 
하지만 이제 여기에 적용된 원리들로 스프링이 추구하는 객체지향적인 설계 기법들을 이해할 수 있다. 이는 아주 오래된 전통적인 그런 것들을 응용한 것이다. (토비 님: 저는 사실 이거 보면서 되게 놀랍거든요)
왜냐하면 3장에서 제시하는 문제들을 해결하는 다양한 당시의 유명한 개발자들이 소개하는 기법들이 있었어요. 
try-catch-final 이라는 반복되는 코드를 작성하고 깜빡해서 close 하는 것을 하나 잊은 상황에서 서버를 일주일 정도 돌린다면 ? 
갑자기 어느날 리소스 풀이라고 나와서 서버가 꺼져버리는 현상을 목격할거고 밤을 세우고 심지어는 소스 코드를 전부 출력을 해서 형광펜으로 하나식 줄을 그어 가면서 `무엇을 빼먹었는가` 에 대해 체크하는 경우도 생긴다. 진짜 그런 일들이 많았다.
그 시절에 스펙(?)을 만든 사람은 `이는 간단한 객체지향적인 디자인 패턴 몇 개만 응용하면 해결되지 않는가` 라는 해답을 내놓았다. (토비 님: 사람들이 이 생각을 왜 못 했을까 ? 자바를 많이 하고 잘한다는 사람들이) 
그중에는 안드로이드의 자바 라이브러리를 총지휘한 유명한 사람도 있는데, 그 사람도 그 사람이 만든 솔루션도 ~ 했거든요. (0사에 대한 이야기) 그 분이 00 에서 컨설턴트로 일하실 때 진짜 그런 상황을 많이 만났다.
(JDBC 로 개발을 진행한 상황) try-catch-final 의 어딘가에서 close 를 안하고 넘어가는게 있는데 A4 용지 한 페이지에 페이지가 네 장이 들어가는 형태로 수백장의 소스 코드를 출력한 다음에 형광펜 하나 잡고 try-catch-final 이 보이는 곳에다가 하나씩 밑줄 그어 가면서 close 빼먹은 곳이 있나 finally 빼먹은 데 있나 4-5 시간 정도를 진행. `이거 고치세요` 이러면 이 사람들한테 XX 원의 컨설팅 비용을 지불하였다. 
2000년대 초반에 유명한 자바 커뮤니티 그 분이 올리신 글을 보고 깜짝 놀랐던 적이 있다. close 를 누락하는 등의 오류는 어찌보면 간단한 코드지만 실수할 수 있는 내용이고 쉽게 찾아내기도 힘들 수 있겠구나라는 것을 절실하게 느꼈다.
(예제 이야기) 그래서 3장에 나오는 내용을 스프링을 통해서 배우게 되어 되게 좋았다. 이렇게 접근해 나가는 동안 객체지향적인 어떤 원리들이 `어떤 문제를 해결하기 위해서 쓰였는가` 이를 쭉 풀어나가는 방식으로 3장을 구성을 했다. 
2008 ~ 2010 년 초반에 이 책이 쓰인 당시에는 자바 6 까지 밖에 안나와서 자바 6 의 언어가 지원하는 내용만 사용을 했다. 
그 이후의 자바 7, 8, ... , 19 까지 나왔는데, 버전이 점점 올라가면서 이 책에서 작성했던 샘플 코드를 좀 더 개선할 수 있는 여러 가지 좋은 방법들이 나왔다. 
어쩌면 여기서 얘기하는 템플릿 콜백에 대한 완전히 새로운 방식의 접근 방법을 사용할 수 있게 되었다. 하지만 그럼에도 불구하고 최신 스프링에도 여전히 템플릿이 존재한다. 그게 어떤 의미가 있는 건지 이런 것들을 한번 쭉 얘기를 해보면 좋을 것 같다.  

## (느낀점) 
DB 접근에 대해 처음 배울 때 접하는 내용이 connection, preparedStatement, 그 다음에 JDBC 템플릿으로 넘어가게 된다. 그 패턴에 익숙해지니 SQL 문을 인터페이스로 분리하는 과정이 `오버엔지니어링이 아닌가 ?` 라 생각되었다. `SQL 문을 구현체로 추출하면 보기만 어렵지 않나 ?` 라는 생각도 했는데, 점점 JDBC 템플릿과 유사한 형태로 리팩토링이 진행됐다.

## (토비 님)
3장은 JDBC 템플릿 그 자체가 목적이 아니고, 이런 류의 문제를 만나게 되면 자바에서는 `어떤 디자인 방법적인 설계로 해결을 할 수 있는가 ?` 를 생각하게 하는게 목적이다. 
해당 챕터에서 나오는 DB 프로그램 작성에 대해 `이런 식으로 접근을 했어야 하나 ?` 라고 생각하는 것 보다는, 이런 코드로 작성을 해야 하던 시절에서 그 `문제를 해결하면서 어떤 접근 방법을 썼는가 ?` 에 대해 더 관심을 가져주는게 좋을 것 같다.


## (느낀점)
이너 클래스가 인상 깊었다. 잘못 사용하면 스파게티 코드가 되기 쉬운 부분이 있다. 직접 사용하기 보다는 `fake` 라는 이름의 로컬 클래스를 만들어서 쓰는 경우가 많다.

## (토비 님)
요즘 언어 차원에서 콜백, 람다를 지원하는 언어들이 워낙 많아서 그냥 그렇게 시작하면 된다고 생각할 수 있는데, 사실 그게 전통적인 객체지향 언어에서 발전해 파생되는 결과물이라 생각한다. 
그래서 이런 방향으로 접근 방법을 보는 것이 좋겠다는 생각이 든다. 


## (느낀점)
처음에는 테스트만 통과할 수 있는 적당히 구현된 코드가 나온다. 그리고 `변하는 것` 과 `변하지 않는 것` 을 분리하며 템플릿 콜백 패턴을 구현하는 과정이 나온다.  
그리고 어떤 설계에 대한 결정을 할 때, `왜 이런 선택을 하는지`, `뭐가 좋은지` 에 대한 이유를 설명한다. 예를 들면, `로컬 클래스를 선언하면 좋은 이유`, 그리고 `인터페이스를 거치지 않고 DI 를 하면 좋은 이유` 와 같은 내용인데 이런 이야기를 읽으면서 이유를 알게 된 것 같아서 되게 좋았다.
우리는 프레임워크에 사용자이면서 동시에 애플리케이션을 만든다. 우리가 애플리케이션을 만들 때도 우리가 사용하는 프레임워크처럼 변경에 유연하고 또 합체하기 쉬운 그런 것을 만들어야 한다. 이 프레임워크에 녹여져 있는 원리들을 배우고 또 적용하면 좋겠다.

## (토비 님)
제가 이 책에서 강조하고 싶었던 것은 스프링이 어느 날 갑자기 `JDBC 개발은 템플릿으로 해` 라며 만들어지지 않았다는 것이다. 스프링을 만든 개발자가 평범한 자바 접근 방법을 사용하여 만들어진 코드를 보고 문제 의식을 느꼈고, 여기에 객체지향적인 원리를 적용하니 이런 형식의 코드가 만들어졌고, 간결해지니 프레임워크화가 되었다. 
`우리가 만든 애플리케이션 코드에도 동일한 원리를 적용할 수 있지 않을까 ?` 사실 이런 내용을 이야기하고 싶었다. 그래서 스프링을 사용하면 `람다를 쓰는 코드` 를 많이 만들게 되는데, `람다를 받는 코드` 를 과연 만들어본 적이 있는지 이런 것을 한 번 생각해 볼 필요가 있을 것 같다. 
남이 만든 라이브러리에 람다식을 넣는 건 쉽게 할 수 있는데, 내가 만든 코드에 내가 만든 또 다른 코드 내지는 다른 사람이 내가 만든 코드를 사용할 때 `람다식을 넣을 수 있도록 만들어 낼 수 있는가 ?` 이 부분에 대한 고민이 필요하다고 생각한다. 예를 들어, 제너레이트, 에노테이션. 
템플릿 부분도 사실 이런 원리들을 적용한 코드를 가지고 고민을 풀어나가는 과정으로 나타내 굉장히 작은 스탭으로 서서히 진행시켰다. 
무슨 뭐하러 로컬 클래스를 만들고 그냥 한방에 가지 이렇게 말씀하시는 분들도 있는데, 근데 저는 이 문제를 풀어나가는 과정의 모든 부분이 답을 준다는 생각을 했고, 해결할 수 있는 솔루션들을 찾아보고, 그 장단점을 비교해보고, 최종적으로 선택지를 결정해서 그 방향으로 한방에 전진하는 식의 문제 접근 과정을 보여주고 싶었다. 


